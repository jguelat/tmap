<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates a tmap-element that specifies facets (small multiples). Small multiples can be created in two ways: 1) by specifying the by argument with one or two variable names, by which the data is grouped, 2) by specifying multiple variable names in any of the aesthetic argument of the layer functions (for instance, the argument col in tm_fill). This function further specifies the facets, for instance number of rows and columns, and whether the coordinate and scales are fixed or free (i.e. independent of each other). An overview of the different approaches to create facets is provided in the examples."><title>Small multiples — tm_facets • tmap</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Small multiples — tm_facets"><meta property="og:description" content="Creates a tmap-element that specifies facets (small multiples). Small multiples can be created in two ways: 1) by specifying the by argument with one or two variable names, by which the data is grouped, 2) by specifying multiple variable names in any of the aesthetic argument of the layer functions (for instance, the argument col in tm_fill). This function further specifies the facets, for instance number of rows and columns, and whether the coordinate and scales are fixed or free (i.e. independent of each other). An overview of the different approaches to create facets is provided in the examples."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.3-4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/tmap-JSS-code.html">tmap: JSS article reproduction code</a>
    <a class="dropdown-item" href="../articles/tmap-changes.html">tmap: version changes</a>
    <a class="dropdown-item" href="../articles/tmap-getstarted.html">tmap: get started!</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-tmap/tmap/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Small multiples</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-tmap/tmap/blob/HEAD/R/tm_misc_elements.R" class="external-link"><code>R/tm_misc_elements.R</code></a></small>
      <div class="d-none name"><code>tm_facets.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a <code><a href="tmap-element.html">tmap-element</a></code> that specifies facets (small multiples). Small multiples can be created in two ways: 1) by specifying the <code>by</code> argument with one or two variable names, by which the data is grouped, 2) by specifying multiple variable names in any of the aesthetic argument of the layer functions (for instance, the argument <code>col</code> in <code><a href="tm_polygons.html">tm_fill</a></code>). This function further specifies the facets, for instance number of rows and columns, and whether the coordinate and scales are fixed or free (i.e. independent of each other). An overview of the different approaches to create facets is provided in the examples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tm_facets</span><span class="op">(</span></span>
<span>  by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  along <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  as.layers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  free.coords <span class="op">=</span> <span class="op">!</span><span class="va">as.layers</span>,</span>
<span>  drop.units <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  drop.empty.facets <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  drop.NA.facets <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sync <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  showNA <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  textNA <span class="op">=</span> <span class="st">"Missing"</span>,</span>
<span>  free.scales <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.symbol.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.symbol.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.symbol.shape <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.text.size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.text.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.line.col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.line.lwd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  free.scales.raster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  inside.original.bbox <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale.factor <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  drop.shapes <span class="op">=</span> <span class="va">drop.units</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>by</dt>
<dd><p>data variable name by which the data is split, or a vector of two variable names to split the data by two variables (where the first is used for the rows and the second for the columns).</p></dd>


<dt>along</dt>
<dd><p>data variable name by which the data is split and plotted on separate pages. This is especially useful for animations made with <code><a href="tmap_animation.html">tmap_animation</a></code>. The <code>along</code> argument can be used in combination with the <code>by</code> argument. It is only supported in <code>"plot"</code> mode (so not in <code>"view"</code> mode).</p></dd>


<dt>as.layers</dt>
<dd><p>logical that determines whether facets are shown as different layers in <code>"view"</code> mode. By default <code>FALSE</code>, i.e. facets are drawn as small multiples.</p></dd>


<dt>ncol</dt>
<dd><p>number of columns of the small multiples grid. Not applicable if <code>by</code> contains two variable names.</p></dd>


<dt>nrow</dt>
<dd><p>number of rows of the small multiples grid. Not applicable if <code>by</code> contains two variable names.</p></dd>


<dt>free.coords</dt>
<dd><p>logical. If the <code>by</code> argument is specified, should each map has its own coordinate ranges? By default <code>TRUE</code>, unless facets are shown in as different layers (<code>as.layers = TRUE</code>)</p></dd>


<dt>drop.units</dt>
<dd><p>logical. If the <code>by</code> argument is specified, should non-selected spatial units be dropped? If <code>FALSE</code>, they are plotted where mapped aesthetics are regarded as missing values. Not applicable for raster shapes. By default <code>TRUE</code>.</p></dd>


<dt>drop.empty.facets</dt>
<dd><p>logical. If the <code>by</code> argument is specified, should empty facets be dropped? Empty facets occur when the <code>by</code>-variable contains unused levels. When <code>TRUE</code> and two <code>by</code>-variables are specified, empty rows and columns are dropped.</p></dd>


<dt>drop.NA.facets</dt>
<dd><p>logical. If the <code>by</code> argument is specified, and all values of the defined aesthetic variables (e.g. <code>col</code> from <code><a href="tm_polygons.html">tm_fill</a></code>) for specific facets, should these facets be dropped? <code>FALSE</code> by default.</p></dd>


<dt>sync</dt>
<dd><p>logical. Should the navigation in view mode (zooming and panning) be synchronized? By default <code>TRUE</code> if the facets have the same bounding box. This is generally the case when rasters are plotted, or when free.coords is <code>FALSE</code>.</p></dd>


<dt>showNA</dt>
<dd><p>If the <code>by</code> argument is specified, should missing values of the <code>by</code>-variable be shown in a facet? If two <code>by</code>-variables are specified, should missing values be shown in an additional row and column? If <code>NA</code>, missing values only are shown if they exist. Similar to the <code>useNA</code> argument of <code><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></code>, where <code>TRUE</code>, <code>FALSE</code>, and <code>NA</code> correspond to <code>"always"</code>, <code>"no"</code>, and <code>"ifany"</code> respectively.</p></dd>


<dt>textNA</dt>
<dd><p>text used for facets of missing values.</p></dd>


<dt>free.scales</dt>
<dd><p>logical. Should all scales of the plotted data variables be free, i.e. independent of each other? Specific scales can be set with <code>free.scales.x</code>, where <code>x</code> is the name of the aesthetic, e.g. <code>"symbol.col"</code>. By default, <code>free.scales</code> is <code>TRUE</code>, unless the <code>by</code> argument is used, the <code>along</code> argument is used, or a <code>stars</code> object with a third dimension is shown.</p></dd>


<dt>free.scales.fill</dt>
<dd><p>logical. Should the color scale for the choropleth be free?</p></dd>


<dt>free.scales.symbol.size</dt>
<dd><p>logical. Should the symbol size scale for the symbol map be free?</p></dd>


<dt>free.scales.symbol.col</dt>
<dd><p>logical. Should the color scale for the symbol map be free?</p></dd>


<dt>free.scales.symbol.shape</dt>
<dd><p>logical. Should the symbol shape scale for the symbol map be free?</p></dd>


<dt>free.scales.text.size</dt>
<dd><p>logical. Should the text size scale be free?</p></dd>


<dt>free.scales.text.col</dt>
<dd><p>logical. Should the text color scale be free?</p></dd>


<dt>free.scales.line.col</dt>
<dd><p>Should the line color scale be free?</p></dd>


<dt>free.scales.line.lwd</dt>
<dd><p>Should the line width scale be free?</p></dd>


<dt>free.scales.raster</dt>
<dd><p>Should the color scale for raster layers be free?</p></dd>


<dt>inside.original.bbox</dt>
<dd><p>If <code>free.coords</code>, should the bounding box of each small multiple be inside the original bounding box?</p></dd>


<dt>scale.factor</dt>
<dd><p>Number that determines how the elements (e.g. font sizes, symbol sizes, line widths) of the small multiples are scaled in relation to the scaling factor of the shapes. The elements are scaled to the <code>scale.factor</code>th root of the scaling factor of the shapes. So, for <code>scale.factor=1</code>, they are scaled proportional to the scaling of the shapes. Since elements, especially text, are often too small to read, a higher value is recommended. By default, <code>scale.factor=2</code>.</p></dd>


<dt>drop.shapes</dt>
<dd><p>deprecated: renamed to <code>drop.units</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code><a href="tmap-element.html">tmap-element</a></code></p>


    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The global option <code>limits</code> controls the limit of the number of facets that are plotted. By default, <code>tmap_options(limits=c(facets.plot=64, facets.view=4))</code>. The maximum number of interactive facets is set to four since otherwise it may become very slow.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tennekes, M., 2018, tmap: Thematic Maps in R, Journal of Statistical Software, 84(6), 1-39, <a href="https://doi.org/10.18637/jss.v084.i06" class="external-link">doi:10.18637/jss.v084.i06</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="../doc/tmap-getstarted.html"><code><a href="../articles/tmap-getstarted.html">vignette("tmap-getstarted")</a></code></a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">World</span>, <span class="va">NLD_muni</span>, <span class="va">NLD_prov</span>, <span class="va">land</span>, <span class="va">metro</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">current.mode</span> <span class="op">&lt;-</span> <span class="fu"><a href="tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tmap mode set to plotting</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CASE 1: Facets defined by constant values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_fill</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forestgreen"</span>, <span class="st">"goldenrod"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_layout.html">tm_format</a></span><span class="op">(</span><span class="st">"World"</span>, title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A green world"</span>, <span class="st">"A dry world"</span><span class="op">)</span>, bg.color<span class="op">=</span><span class="st">"lightskyblue2"</span>, </span></span>
<span class="r-in"><span>    title.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tm_facets-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CASE 2: Facets defined by multiple variables</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"well_being"</span>, <span class="st">"life_exp"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      style<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pretty"</span>, <span class="st">"fixed"</span><span class="op">)</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">85</span>, by <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Oranges"</span>, <span class="st">"Purples"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      border.col <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>        title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Well-Being Index"</span>, <span class="st">"Life Expectancy"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_layout.html">tm_format</a></span><span class="op">(</span><span class="st">"World"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="tm_facets-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">NLD_muni</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_fill</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pop_0_14"</span>, <span class="st">"pop_15_24"</span>, <span class="st">"pop_25_44"</span>, <span class="st">"pop_45_64"</span>, <span class="st">"pop_65plus"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        style<span class="op">=</span><span class="st">"kmeans"</span>, </span></span>
<span class="r-in"><span>        palette<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Oranges"</span>, <span class="st">"Greens"</span>, <span class="st">"Blues"</span>, <span class="st">"Purples"</span>, <span class="st">"Greys"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Population 0 to 14"</span>, <span class="st">"Population 15 to 24"</span>, <span class="st">"Population 25 to 44"</span>,</span></span>
<span class="r-in"><span>            <span class="st">"Population 45 to 64"</span>, <span class="st">"Population 65 and older"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">NLD_prov</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_borders</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_layout.html">tm_format</a></span><span class="op">(</span><span class="st">"NLD"</span>, frame <span class="op">=</span> <span class="cn">TRUE</span>, asp<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CASE 3: Facets defined by group-by variable(s)</span></span></span>
<span class="r-in"><span><span class="co"># A group-by variable that divides the objects spatially</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">NLD_prov</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="st">"gold2"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">tm_facets</span><span class="op">(</span>by<span class="op">=</span><span class="st">"name"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-plt img"><img src="tm_facets-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">NLD_muni</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_borders</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">tm_facets</span><span class="op">(</span>by<span class="op">=</span><span class="st">"province"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_fill</a></span><span class="op">(</span><span class="st">"population"</span>, style<span class="op">=</span><span class="st">"kmeans"</span>, convert2density <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">NLD_prov</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_polygons.html">tm_borders</a></span><span class="op">(</span>lwd<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">tm_facets</span><span class="op">(</span>by<span class="op">=</span><span class="st">"name"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The objects are divided by a non-spatial variable (e.g. date/time)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">metro_long</span> <span class="op">&lt;-</span> <span class="va">metro</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">population</span>, <span class="op">-</span><span class="va">name</span>, <span class="op">-</span><span class="va">name_long</span>, <span class="op">-</span><span class="va">iso_a3</span>, <span class="op">-</span><span class="va">geometry</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">year</span>, <span class="fl">4</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">metro_long</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tm_symbols.html">tm_bubbles</a></span><span class="op">(</span><span class="st">"population"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">tm_facets</span><span class="op">(</span>by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: dplyr</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: tidyr</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> old-style crs object detected; please recreate object with a recent sf::st_crs()</span>
<span class="r-plt img"><img src="tm_facets-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">land</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tm_raster.html">tm_raster</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">tm_facets</span><span class="op">(</span>by<span class="op">=</span><span class="st">"cover_cls"</span>, free.coords <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Facets defined by two group-by variables</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">World</span><span class="op">$</span><span class="va">HPI3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">World</span><span class="op">$</span><span class="va">HPI</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">35</span>, <span class="fl">50</span>, <span class="fl">65</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HPI low"</span>, <span class="st">"HPI medium"</span>, <span class="st">"HPI high"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">World</span><span class="op">$</span><span class="va">GDP3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">World</span><span class="op">$</span><span class="va">gdp_cap_est</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span>, <span class="fl">20000</span>, <span class="cn">Inf</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GDP low"</span>, <span class="st">"GDP medium"</span>, <span class="st">"GDP high"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="tm_polygons.html">tm_fill</a></span><span class="op">(</span><span class="st">"HPI3"</span>, palette<span class="op">=</span><span class="st">"Dark2"</span>, colorNA<span class="op">=</span><span class="st">"grey90"</span>, legend.show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>  <span class="fu">tm_facets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HPI3"</span>, <span class="st">"GDP3"</span><span class="op">)</span>, showNA<span class="op">=</span><span class="cn">FALSE</span>, free.coords <span class="op">=</span> <span class="cn">FALSE</span>, drop.units <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">metro_edited</span> <span class="op">&lt;-</span> <span class="va">metro</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pop1950cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">pop1950</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span><span class="op">*</span><span class="fl">1e6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       pop2020cat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">pop2020</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">40</span><span class="op">)</span><span class="op">*</span><span class="fl">1e6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tm_polygons.html">tm_fill</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">metro_edited</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_symbols.html">tm_dots</a></span><span class="op">(</span><span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">tm_facets</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pop1950cat"</span>, <span class="st">"pop2020cat"</span><span class="op">)</span>, free.coords <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tm_layout.html">tm_layout</a></span><span class="op">(</span>panel.label.rot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span>, panel.label.size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># restore current mode</span></span></span>
<span class="r-in"><span><span class="fu"><a href="tmap_mode.html">tmap_mode</a></span><span class="op">(</span><span class="va">current.mode</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> tmap mode set to plotting</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Martijn Tennekes.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

