<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tmap: legends • tmap</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tmap: legends">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.99.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01_tmap_intro_v4.html">Introducing tmap 4</a></li>
    <li><a class="dropdown-item" href="../articles/02_tmap_diff_v3.html">tmap: diff(v4, v3)</a></li>
    <li><a class="dropdown-item" href="../articles/03_tmap_vv.html">tmap: visual variables</a></li>
    <li><a class="dropdown-item" href="../articles/04_tmap_scales.html">tmap: scales</a></li>
    <li><a class="dropdown-item" href="../articles/05_tmap_facets.html">tmap: facets</a></li>
    <li><a class="dropdown-item" href="../articles/06_tmap_legends.html">tmap: legends</a></li>
    <li><a class="dropdown-item" href="../articles/07_tmap_charts.html">tmap: charts</a></li>
    <li><a class="dropdown-item" href="../articles/08_tmap_basemaps.html">tmap: basemaps</a></li>
    <li><a class="dropdown-item" href="../articles/09_tmap_shiny.html">tmap: shiny integration</a></li>
    <li><a class="dropdown-item" href="../articles/10_tmap_export.html">tmap: exporting maps</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-tmap/tmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>tmap: legends</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-tmap/tmap/blob/master/vignettes/06_tmap_legends.Rmd" class="external-link"><code>vignettes/06_tmap_legends.Rmd</code></a></small>
      <div class="d-none name"><code>06_tmap_legends.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>tmap</strong> is an R package for spatial data visualization. This vignette describes the alpha version of the major update (version 4), which will be on CRAN in the course of 2024.</p>
<div class="section level3">
<h3 id="tmap-4---tmap-3-x">tmap 4 - tmap 3.x<a class="anchor" aria-label="anchor" href="#tmap-4---tmap-3-x"></a>
</h3>
<ul>
<li><p><strong>tmap 3.x</strong> supports several map layer variables, for example <code>"col"</code>, <code>"size"</code>, and <code>"shape"</code> for the <code><a href="../reference/tm_symbols.html">tm_symbols()</a></code> map layer function. There will be many more of those variables in <strong>tmap 4</strong>. Besides the visual variables, so-called transformation variables also will be available. A <em>transformation variable</em> role is to change the spatial coordinates (for instance, to create a cartogram). A <em>visual variable</em> only changes the appearance of a spatial object, e.g. fill color or line width. You can find some examples of these variables below.</p></li>
<li><p>Map layer arguments (e.g. the arguments of <code><a href="../reference/tm_polygons.html">tm_polygons()</a></code>) are much better organized: for each visual/transformation variable, there are only four arguments. In case of the fill visual variable, these are: <code>fill</code>, <code>fill.scale</code>, <code>fill.legend</code> and <code>fill.free</code>, which respectively specify the data variable or visual value that defines the polygon fill color, the used scaling function, the legend layout, and whether scales are applied freely across facets.</p></li>
<li><p>The input for each visual/transformation variable can be multivariate, in the sense that multiple data variables are scaled to one transformation of visual variable. An example is a bivariate choropleth, in which a cross tabulation of two data variables is mapped to one (bivariate) color palette.</p></li>
<li><p>User-defined map layer functions can be written (e.g. as an extension package).</p></li>
<li><p>Like <strong>tmap 3.x</strong>, <strong>tmap 4.0</strong> comes with two modes, a <code>"plot"</code> and a <code>"view"</code> mode. However, other modes can be added as well, so you may expect an extension package <strong>tmap.rayshader</strong> at some point (or start writing one yourself).</p></li>
<li><p>Legends and other map components (such as scale bars) can be drawn anywhere on or outside the map.</p></li>
<li><p>The layout of legends has been improved and made much more flexible.</p></li>
<li><p>It is possible to combine legends, which is useful if the same data variable is applied for multiple visual variables using the same scaling function.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="tmap-4---ggplot2">tmap 4 - ggplot2<a class="anchor" aria-label="anchor" href="#tmap-4---ggplot2"></a>
</h3>
<p>The <strong>tmap</strong> package is very similar to <strong>ggplot2</strong> and its Grammar of Graphics, but tailored to spatial data visualization, whereas <strong>ggplot2</strong> is much more general. More specifically:</p>
<ul>
<li><p>In <strong>tmap</strong>, the visual/transformation variables are always specifies in the map layer functions, whereas in ggplot2 the aesthetics are usually specified at plot level.</p></li>
<li><p>In <strong>ggplot2</strong>, scales are determined on plot level, whereas in <strong>tmap</strong>, they are determined on map layer level.</p></li>
<li><p>In <strong>tmap</strong>, spatial data (e.g. an <code>sf</code> object) is specified with <code><a href="../reference/tm_shape.html">tm_shape()</a></code>. The spatial coordinates (<code>x</code> and <code>y</code>) are considered to be part of the data (which can be changed with transformation variables). In principle, any map layer function can be used with any spatial class. E.g. <code><a href="../reference/tm_symbols.html">tm_dots()</a></code> renders dots for <code>sf</code> points data, but it also works for other spatial classes: e.g. centroids for <code>sf</code> polygons/lines and raster data (<strong>stars</strong> / <strong>terra</strong> packages). However, in <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code>, each spatial class requires a custom map layer function, e.g. <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::geom_sf()</a></code> for <code>sf</code> objects.</p></li>
<li><p><strong>tmap</strong> has a static plot mode and an interactive mode.</p></li>
<li><p>…</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="tmap-4---other-r-packages">tmap 4 - other R packages<a class="anchor" aria-label="anchor" href="#tmap-4---other-r-packages"></a>
</h3>
<p>There are several great R packages for spatial data visualization, including: <strong>ggplot2</strong>, <strong>mapview</strong>, <strong>leaflet</strong>, <strong>mapsf</strong>, and the generic plot function.</p>
<p>The interactive <code>"view"</code> mode of <strong>tmap</strong> is similar to <strong>mapview</strong> in the sense that it uses the same building blocks (packages like <strong>leaflet</strong>, <strong>leafsync</strong>, and <strong>leafgl</strong>).</p>
<p>Colors are important for data visualization. For this purpose, <strong>tmap</strong> uses <strong>cols4all</strong>, a new R package to analyse color palettes, and check their color-blind-friendliness and other properties.</p>
</div>
</div>
<div class="section level2">
<h2 id="map-layers">Map layers<a class="anchor" aria-label="anchor" href="#map-layers"></a>
</h2>
<p>A (thematic) map consists of one or more <strong>map layers</strong>. Each map layer has a specific set of variables that determine how the objects of that layer are drawn. We distinguish two type of variables: <strong>transformation variables</strong> and <strong>visual variables</strong>. A transformation variable is used to change the spatial coordinates (for instance, a cartogram which distorts polygons). A visual variable only changes the appearance of a spatial object, e.g. fill color or line width.</p>
<p>Transformation variables will only be used for specific map layers such as the cartogram, whereas visual variables will used in almost all map layers.</p>
</div>
<div class="section level2">
<h2 id="visual-variables">Visual variables<a class="anchor" aria-label="anchor" href="#visual-variables"></a>
</h2>
<p>A <strong>visual variable</strong> describes a certain visual property of a drawn object, such as color, size, shape, line width, line stroke, transparency, fill pattern (in <strong>ggplot2</strong> these are called aesthetics). A visual variable can be specified using a constant value (e.g. <code>fill = "blue"</code>) or be <strong>data-driven</strong> (more on this later). If it can <em>only</em> be specified with a constant value, it is called a <strong>visual constant</strong>.</p>
<p>The following table shows which visual variables are used in standard map layers.</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="50%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Map layer</th>
<th>Visual variables</th>
<th>Visual constant</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/tm_basemap.html">tm_basemap()</a></code></td>
<td>none</td>
<td><code>alpha</code></td>
</tr>
<tr class="even">
<td><code><a href="../reference/tm_polygons.html">tm_polygons()</a></code></td>
<td>
<code>fill</code> (fill color), <code>col</code> (border color), <code>lwd</code> (border line width) <code>lty</code> (border line type), <code>fill_alpha</code> (fill transparency), <code>col_alpha</code> (border color transparency)</td>
<td>
<code>linejoin</code> (line join) and <code>lineend</code> (line end)</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/tm_symbols.html">tm_symbols()</a></code></td>
<td>
<code>fill</code> (fill color), <code>col</code> (border color), <code>size</code>, <code>shape</code>, <code>lwd</code> (border line width) <code>lty</code> (border line type), <code>fill_alpha</code> fill transparency, <code>col_alpha</code> border color transparency</td>
<td>
<code>linejoin</code> (line join) and <code>lineend</code> (line end)</td>
</tr>
<tr class="even">
<td><code><a href="../reference/tm_lines.html">tm_lines()</a></code></td>
<td>
<code>col</code> (color), <code>lwd</code> (line width) <code>lty</code> (line type), <code>alpha</code> transparency</td>
<td>
<code>linejoin</code> (line join) and <code>lineend</code> (line end)</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/tm_raster.html">tm_raster()</a></code></td>
<td>
<code>col</code> (color), <code>alpha</code> (transparency)</td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="../reference/tm_text.html">tm_text()</a></code></td>
<td>
<code>size</code>, <code>col</code>
</td>
<td></td>
</tr>
</tbody>
</table>
<p>New in <strong>tmap 4.0</strong> is that users can write their own custom map layer functions; more on this in another vignette. Important for now is that map layers and their visual variables can be extended if needed.</p>
<div class="section level3">
<h3 id="constant-visual-values">Constant visual values<a class="anchor" aria-label="anchor" href="#constant-visual-values"></a>
</h3>
<p>The following code draws gold country polygons.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="st">"gold"</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_tmap_legends_files/figure-html/unnamed-chunk-3-1.png"><!-- --></p>
<p>All the visual variables mentioned in the previous table are used, but with constant values. For instance, polygon borders are drawn with width <code>lwd</code> and colored with <code>col</code>. Each of these visual variables has a default value, in case of the border width and color respectively <code>1</code> and <code>"black"</code>. The only visual variable for which we have specified a different value is <code>fill</code>, which we have set to <code>"gold"</code>.</p>
<p>For those who are completely new to <strong>tmap</strong>: the function <code><a href="../reference/tm_shape.html">tm_shape()</a></code> specifies the spatial data object, which can be any spatial data object from the packages <code>sf</code>, <code>stars</code>, <code>terra</code>, <code>sp</code>, and <code>raster</code>. The subsequent map layer functions (stacked with the <code>+</code> operator) specify how this spatial data is visualized.</p>
<p>In the next example we have three layers: a basemap from OpenTopoMap, country polygon boundaries, and dots for metropolitan areas:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"maptiles"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="fu"><a href="../reference/tm_basemap.html">tm_basemap</a></span><span class="op">(</span>server <span class="op">=</span> <span class="st">"OpenTopoMap"</span>, zoom <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span>, bbox <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">180</span>, xmax <span class="op">=</span> <span class="fl">180</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">86</span>, ymax <span class="op">=</span> <span class="fl">86</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">metro</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_symbols.html">tm_symbols</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="../reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>inner.margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required namespace: maptiles</span></span>
<span><span class="co">#&gt; Warning: Current projection unknown. Long lat coordinates (wgs84) assumed.</span></span></code></pre></div>
<p><img src="06_tmap_legends_files/figure-html/unnamed-chunk-4-1.png"><!-- --></p>
<p>Each visual variable argument can also be specified with a data variable (e.g., a column name). What happens in that case is that the values of data variable are mapped to values of the corresponding visual variable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="st">"life_exp"</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_tmap_legends_files/figure-html/unnamed-chunk-5-1.png"><!-- --></p>
<p>In this example, life expectancy per country is shown, or to put it more precisely: the <em>data variable</em> life expectancy is mapped to the <em>visual variable</em> polygon fill.</p>
<p>To understand this data mapping, consider the following schematic dataset:</p>
<pre><code><span><span class="co">#&gt;       geom  x1   vv1</span></span>
<span><span class="co">#&gt; 1 polygon1  72 blue6</span></span>
<span><span class="co">#&gt; 2 polygon2  58 blue3</span></span>
<span><span class="co">#&gt; 3 polygon3  52 blue2</span></span>
<span><span class="co">#&gt; 4 polygon4  73 blue7</span></span>
<span><span class="co">#&gt; 5      ... ...   ...</span></span></code></pre>
<p>The first column contains spatial geometries (in this case polygons, but they can also be points, lines, and raster tiles). The second column is the data variable that we would like to show. The third column contains the visual values, in this case colors.</p>
<p>Important to note is that there are many ways to scale data values to visual values. In this example data values are put into 5 year intervals and a sequential discrete blue scale is used to show these. With the <code>tm_scale_*()</code> family of functions, users are free to create other scales.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="st">"life_exp"</span>, fill.scale <span class="op">=</span> <span class="fu"><a href="../reference/tm_scale_continuous.html">tm_scale_continuous</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"-carto.earth"</span><span class="op">)</span>, fill.legend <span class="op">=</span> <span class="fu"><a href="../reference/tm_legend.html">tm_legend</a></span><span class="op">(</span><span class="st">"Life\nExpectancy"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">[plot mode]</span> fit legend/component: Some legend items or map compoments do not</span></span>
<span><span class="co">#&gt; fit well, and are therefore rescaled. Set the tmap option 'component.autoscale'</span></span>
<span><span class="co">#&gt; to FALSE to disable rescaling.</span></span></code></pre></div>
<p><img src="06_tmap_legends_files/figure-html/unnamed-chunk-7-1.png"><!-- --></p>
<p>This map uses a continuous color scale with colors from CARTO. More on scales later.</p>
</div>
</div>
<div class="section level2">
<h2 id="transformation-variables">Transformation variables<a class="anchor" aria-label="anchor" href="#transformation-variables"></a>
</h2>
<p>Besides visual variables, map layer may use spatial transformation variables.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cartogram"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span>, crs <span class="op">=</span> <span class="fl">8857</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_cartogram.html">tm_cartogram</a></span><span class="op">(</span>size <span class="op">=</span> <span class="st">"pop_est"</span>, fill <span class="op">=</span> <span class="st">"income_grp"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required namespace: cartogram</span></span>
<span><span class="co">#&gt; Cartogram in progress...</span></span></code></pre></div>
<p><img src="06_tmap_legends_files/figure-html/unnamed-chunk-8-1.png"><!-- --></p>
<p>We used two variables: <code>size</code> to deform the polygons using a continuous cartogram and <code>fill</code> to color the polygons.
The former is an example of a <em>transformation variable</em>. In our example schematic dataset:</p>
<pre><code><span><span class="co">#&gt;       geom         x1 x_scaled geom_transformed</span></span>
<span><span class="co">#&gt; 1 polygon1    491,775   0.0007        polygon1'</span></span>
<span><span class="co">#&gt; 2 polygon2  2,231,503   0.0033        polygon2'</span></span>
<span><span class="co">#&gt; 3 polygon3 34,859,364   0.0554        polygon3'</span></span>
<span><span class="co">#&gt; 4 polygon4  4,320,748   0.0067        polygon4'</span></span>
<span><span class="co">#&gt; 5      ...        ...      ...              ...</span></span></code></pre>
<p>The data variable <code>x1</code>, in the example <code>pop_est</code> (population estimation), is scaled to <code>x1_scaled</code> which is in this case a normalization using a continuous scale. Next, the geometries are distorted such that the areas are proportional to <code>x1_scaled</code> (as much as the cartogram algorithm is able to achieve).</p>
</div>
<div class="section level2">
<h2 id="scales">Scales<a class="anchor" aria-label="anchor" href="#scales"></a>
</h2>
<p>Each visual variable and each transformation variable can be scaled with one of the <code>tm_scale_</code> functions. To illustrate the different options, we show life expectancy across Africa, which we round in order to use the categorical scales as well.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span></span>
<span><span class="va">Africa</span> <span class="op">=</span> <span class="va">World</span><span class="op">[</span><span class="va">World</span><span class="op">$</span><span class="va">continent</span> <span class="op">==</span> <span class="st">"Africa"</span>, <span class="op">]</span></span>
<span><span class="va">Africa</span><span class="op">$</span><span class="va">life_exp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">Africa</span><span class="op">$</span><span class="va">life_exp</span><span class="op">)</span></span></code></pre></div>
<p>Like <strong>tmap 3.x</strong>, it is possible to create facets by specifying multiple data variable names and scales to one visual (or transformation) variable, in this case <code>"fill"</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">Africa</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"life_exp"</span>, <span class="fl">6</span><span class="op">)</span>, </span>
<span>                fill.scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/tm_scale_categorical.html">tm_scale_categorical</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="../reference/tm_scale_categorical.html">tm_scale_ordinal</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="../reference/tm_scale_intervals.html">tm_scale_intervals</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="../reference/tm_scale_continuous.html">tm_scale_continuous</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="../reference/tm_scale_continuous.html">tm_scale_continuous_log</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                                  <span class="fu"><a href="../reference/tm_scale_discrete.html">tm_scale_discrete</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                fill.legend <span class="op">=</span> <span class="fu"><a href="../reference/tm_legend.html">tm_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">""</span>, position <span class="op">=</span> <span class="fu"><a href="../reference/tm_pos.html">tm_pos_in</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>panel.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tm_scale_categorical"</span>, <span class="st">"tm_scale_ordinal"</span>, <span class="st">"tm_scale_intervals"</span>, <span class="st">"tm_scale_continuous"</span>, <span class="st">"tm_scale_continuous_log"</span>, <span class="st">"tm_scale_discrete"</span><span class="op">)</span>, </span>
<span>              inner.margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>              legend.text.size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_tmap_legends_files/figure-html/unnamed-chunk-11-1.png"><!-- --></p>
<p>Both <code><a href="../reference/tm_scale_categorical.html">tm_scale_categorical()</a></code> and <code><a href="../reference/tm_scale_categorical.html">tm_scale_ordinal()</a></code> tread data as categorical data, so ignoring the fact that they are actually numbers. The only difference is that categorical does not assume any order between the categories, whereas ordinal does. This is similar to a factor in R which can be ordered or not.</p>
<p>The other shown scales can only be applied to numeric data. Note that in this example the breaks of <code><a href="../reference/tm_scale_intervals.html">tm_scale_intervals()</a></code> are similar to the tick marks of <code>tm_scale_continous()</code>. However, when using class intervals only a few colors are used (in this case 6 plus a color for missing values) whereas in a continuous scale a gradient of colors is used. The advantage of using class intervals is that it is relatively easy to read data values from the map, e.g. the value of South Africa is 55 to 60, while the advantage of using a continuous color scale is that the colors in the map are more accurate (because they are unrounded).</p>
<p>For <code><a href="../reference/tm_scale_intervals.html">tm_scale_intervals()</a></code> it is possible to chose how to determine the breaks (with the argument <code>style</code>). For <code>tm_scale_continous()</code> it is possible to use a transformation function: in this case the built-in log transformation is used (which is pretty useless for this particular example because of the data range).</p>
<p>Finally, <code><a href="../reference/tm_scale_discrete.html">tm_scale_discrete()</a></code> uses a discrete linear scale. Note that this is different than <code><a href="../reference/tm_scale_categorical.html">tm_scale_ordinal()</a></code>, which does not use colors for values that are not present (as categories), for instance 53.</p>
<p>Each <code>tm_scale_*()</code> functions can (in principle) be applied to any visual or transformation variable. Note that this is different from <strong>ggplot2</strong> where scales are organized by variable and by type (e.g. <code><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">ggplot2::scale_fill_continuous()</a></code>). This is related to another difference with <strong>ggplot2</strong>. In <strong>tmap</strong>, the scales are set directly in the map layer function to the target visual/transformation variable, for instance <code>tm_polygons(fill = "x", fill.scale = tm_scale_continuous())</code>. In <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>, scales are set outside the layer functions.</p>
<p>Each <code>tm_scale_</code> function has (at least) the following arguments: <code>values</code>, <code>values.repeat</code>, <code>values.range</code>, <code>values.scale</code>, <code>value.na</code>, <code>value.null</code>, <code>value.neutral</code>, <code>labels</code>, <code>label.na</code>, <code>label.null</code>, and <code>label.format</code>.
The <code>value*</code> arguments determine the visual values to which the data values are mapped. In case the scale is applied to a visual variable that represents color, they takes color values or a color palette. However, if for instance the same scale is applied to line width, then values should be numeric values that represent line widths.</p>
<p>This is illustrated in the following example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"HPI"</span>, fill.scale <span class="op">=</span> <span class="fu"><a href="../reference/tm_scale_intervals.html">tm_scale_intervals</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"scico.roma"</span>, value.na <span class="op">=</span> <span class="st">"grey95"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">45</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_symbols.html">tm_symbols</a></span><span class="op">(</span>size <span class="op">=</span> <span class="st">"HPI"</span>, size.scale <span class="op">=</span> <span class="fu"><a href="../reference/tm_scale_intervals.html">tm_scale_intervals</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.5</span>, <span class="fl">0.8</span><span class="op">)</span>, value.na <span class="op">=</span> <span class="fl">0.1</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">45</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"grey30"</span><span class="op">)</span></span></code></pre></div>
<p><img src="06_tmap_legends_files/figure-html/unnamed-chunk-12-1.png"><!-- --></p>
<p>The defaults for those <code>value.*</code> arguments are stored in the <strong>tmap</strong> options. For instance</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tmap_options.html">tmap_options</a></span><span class="op">(</span><span class="st">"values.var"</span><span class="op">)</span><span class="op">$</span><span class="va">values.var</span><span class="op">$</span><span class="va">fill</span></span>
<span><span class="co">#&gt; $seq</span></span>
<span><span class="co">#&gt; [1] "-hcl.blues3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $div</span></span>
<span><span class="co">#&gt; [1] "pu_gn_div"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $unord</span></span>
<span><span class="co">#&gt; [1] "cols4all.area7"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ord</span></span>
<span><span class="co">#&gt; [1] "-hcl.blues3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cyc</span></span>
<span><span class="co">#&gt; [1] "tol.rainbow_pu_rd"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $biv</span></span>
<span><span class="co">#&gt; [1] "pu_gn_bivs"</span></span></code></pre></div>
<p>contains the default color palettes for the visual variable <code>"fill"</code> for different types of data. For instance, when data values are all positive numbers, and <code><a href="../reference/tm_scale_intervals.html">tm_scale_intervals()</a></code> or <code><a href="../reference/tm_scale_continuous.html">tm_scale_continuous()</a></code> is applied, the default color palette is <code>"hcl.blues3"</code>, as can be seen in the examples above.</p>
<p>Regarding the available color palettes: <strong>tmap</strong> uses the new R package <strong>cols4all</strong> which contains a large number of well-known color palettes.
Please run <code><a href="https://mtennekes.github.io/cols4all/reference/c4a_gui.html" class="external-link">cols4all::c4a_gui()</a></code> which starts an interactive tool (the successor of <code><a href="https://rdrr.io/pkg/tmaptools/man/palette_explorer.html" class="external-link">tmaptools::palette_explorer()</a></code>).
Of course, also own color palettes can be loaded directly via a vector of color codes.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martijn Tennekes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
