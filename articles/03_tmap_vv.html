<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tmap: visual variables • tmap</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tmap: visual variables">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.99.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/00_grammar_of_graphics.html">grammar of graphics applied</a></li>
    <li><a class="dropdown-item" href="../articles/01_tmap_intro_v4.html">Introducing tmap 4</a></li>
    <li><a class="dropdown-item" href="../articles/02_tmap_diff_v3.html">tmap: diff(v4, v3)</a></li>
    <li><a class="dropdown-item" href="../articles/03_tmap_vv.html">tmap: visual variables</a></li>
    <li><a class="dropdown-item" href="../articles/04_tmap_scales.html">tmap: scales</a></li>
    <li><a class="dropdown-item" href="../articles/05_tmap_facets.html">tmap: facets</a></li>
    <li><a class="dropdown-item" href="../articles/06_tmap_legends.html">tmap: legends</a></li>
    <li><a class="dropdown-item" href="../articles/07_tmap_charts.html">tmap: charts</a></li>
    <li><a class="dropdown-item" href="../articles/08_tmap_basemaps.html">tmap: basemaps</a></li>
    <li><a class="dropdown-item" href="../articles/09_tmap_shiny.html">tmap: shiny integration</a></li>
    <li><a class="dropdown-item" href="../articles/10_tmap_export.html">tmap: exporting maps</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-tmap/tmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>tmap: visual variables</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-tmap/tmap/blob/master/vignettes/03_tmap_vv.Rmd" class="external-link"><code>vignettes/03_tmap_vv.Rmd</code></a></small>
      <div class="d-none name"><code>03_tmap_vv.Rmd</code></div>
    </div>

    
    
<p>A <strong>visual variable</strong> describes a certain visual property of a drawn object, such as color, size, shape, line width, line stroke, transparency, fill pattern (in <strong>ggplot2</strong> these are called aesthetics).
A visual variable can be specified using a constant value (e.g. <code>fill = "blue"</code>) or be <strong>data-driven</strong> (more on this later).
If it can <em>only</em> be specified with a constant value, it is called a <strong>visual constant</strong>.</p>
<p>The following table shows which visual variables are used in standard map layers.</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="50%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Map layer</th>
<th>Visual variables</th>
<th>Visual constant</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/tm_basemap.html">tm_basemap()</a></code></td>
<td>none</td>
<td><code>alpha</code></td>
</tr>
<tr class="even">
<td><code><a href="../reference/tm_polygons.html">tm_polygons()</a></code></td>
<td>
<code>fill</code> (fill color), <code>col</code> (border color), <code>lwd</code> (border line width), <code>lty</code> (border line type), <code>fill_alpha</code> (fill transparency), <code>col_alpha</code> (border color transparency)</td>
<td>
<code>linejoin</code> (line join) and <code>lineend</code> (line end)</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/tm_symbols.html">tm_symbols()</a></code></td>
<td>
<code>fill</code> (fill color), <code>col</code> (border color), <code>size</code>, <code>shape</code>, <code>lwd</code> (border line width) <code>lty</code> (border line type), <code>fill_alpha</code> fill transparency, <code>col_alpha</code> border color transparency</td>
<td>
<code>linejoin</code> (line join) and <code>lineend</code> (line end)</td>
</tr>
<tr class="even">
<td><code><a href="../reference/tm_lines.html">tm_lines()</a></code></td>
<td>
<code>col</code> (color), <code>lwd</code> (line width), <code>lty</code> (line type), <code>alpha</code> transparency</td>
<td>
<code>linejoin</code> (line join) and <code>lineend</code> (line end)</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/tm_raster.html">tm_raster()</a></code></td>
<td>
<code>col</code> (color), <code>alpha</code> (transparency)</td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="../reference/tm_text.html">tm_text()</a></code></td>
<td>
<code>size</code>, <code>col</code>
</td>
<td></td>
</tr>
</tbody>
</table>
<p>New in <strong>tmap 4.0</strong> is that users can write their own custom map layer functions; more on this in another vignette.
Important for now is that map layers and their visual variables can be extended if needed.</p>
<div class="section level3">
<h3 id="constant-visual-values">Constant visual values<a class="anchor" aria-label="anchor" href="#constant-visual-values"></a>
</h3>
<p>The following code draws gold country polygons.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="st">"gold"</span><span class="op">)</span></span></code></pre></div>
<p><img src="03_tmap_vv_files/figure-html/unnamed-chunk-3-1.png"><!-- --></p>
<p>All the visual variables mentioned in the previous table are used, but with constant values.
For instance, polygon borders are drawn with width <code>lwd</code> and colored with <code>col</code>.
Each of these visual variables has a default value, in case of the border width and color respectively <code>1</code> and <code>"black"</code>.
The only visual variable for which we have specified a different value is <code>fill</code>, which we have set to <code>"gold"</code>.</p>
<p>For those who are completely new to <strong>tmap</strong>: the function <code><a href="../reference/tm_shape.html">tm_shape()</a></code> specifies the spatial data object, which can be any spatial data object from the packages <code>sf</code>, <code>stars</code>, <code>terra</code>, <code>sp</code>, and <code>raster</code>.
The subsequent map layer functions (stacked with the <code>+</code> operator) specify how this spatial data is visualized.</p>
<p>In the next example we have three layers: a basemap from OpenTopoMap, country polygon boundaries, and dots for metropolitan areas:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"maptiles"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="fu"><a href="../reference/tm_basemap.html">tm_basemap</a></span><span class="op">(</span>server <span class="op">=</span> <span class="st">"OpenTopoMap"</span>, zoom <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span>, bbox <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">180</span>, xmax <span class="op">=</span> <span class="fl">180</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="fl">86</span>, ymax <span class="op">=</span> <span class="fl">86</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">metro</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_symbols.html">tm_symbols</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="../reference/tm_layout.html">tm_layout</a></span><span class="op">(</span>inner.margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required namespace: maptiles</span></span>
<span><span class="co">#&gt; Warning: Current projection unknown. Long lat coordinates (wgs84) assumed.</span></span></code></pre></div>
<p><img src="03_tmap_vv_files/figure-html/unnamed-chunk-4-1.png"><!-- --></p>
<p>Each visual variable argument can also be specified with a data variable (e.g., a column name). What happens in that case is that the values of data variable are mapped to values of the corresponding visual variable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="st">"life_exp"</span><span class="op">)</span></span></code></pre></div>
<p><img src="03_tmap_vv_files/figure-html/unnamed-chunk-5-1.png"><!-- --></p>
<p>In this example, life expectancy per country is shown, or to put it more precisely: the <em>data variable</em> life expectancy is mapped to the <em>visual variable</em> polygon fill.</p>
<p>To understand this data mapping, consider the following schematic dataset:</p>
<pre><code><span><span class="co">#&gt;       geom  x1   vv1</span></span>
<span><span class="co">#&gt; 1 polygon1  72 blue6</span></span>
<span><span class="co">#&gt; 2 polygon2  58 blue3</span></span>
<span><span class="co">#&gt; 3 polygon3  52 blue2</span></span>
<span><span class="co">#&gt; 4 polygon4  73 blue7</span></span>
<span><span class="co">#&gt; 5      ... ...   ...</span></span></code></pre>
<p>The first column contains spatial geometries (in this case polygons, but they can also be points, lines, and raster tiles).
The second column is the data variable that we would like to show. T
The third column contains the visual values, in this case, colors.</p>
<p>Important to note is that there are many ways to scale data values to visual values.
In this example, data values are put into 5-year intervals, and a sequential discrete blue scale is used to show these.
With the <code>tm_scale_*()</code> family of functions, users are free to create other scales.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_polygons.html">tm_polygons</a></span><span class="op">(</span><span class="st">"life_exp"</span>, </span>
<span>                fill.scale <span class="op">=</span> <span class="fu"><a href="../reference/tm_scale_continuous.html">tm_scale_continuous</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"-carto.earth"</span><span class="op">)</span>, </span>
<span>                fill.legend <span class="op">=</span> <span class="fu"><a href="../reference/tm_legend.html">tm_legend</a></span><span class="op">(</span><span class="st">"Life\nExpectancy"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">[plot mode]</span> fit legend/component: Some legend items or map compoments do not</span></span>
<span><span class="co">#&gt; fit well, and are therefore rescaled.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Set the tmap option `component.autoscale = FALSE` to disable rescaling.</span></span></code></pre></div>
<p><img src="03_tmap_vv_files/figure-html/unnamed-chunk-7-1.png"><!-- --></p>
<p>This map uses a continuous color scale with colors from CARTO.
More on scales later.</p>
</div>
<div class="section level2">
<h2 id="transformation-variables">Transformation variables<a class="anchor" aria-label="anchor" href="#transformation-variables"></a>
</h2>
<p>Besides visual variables, map layer may use spatial transformation variables.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"cartogram"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="fu"><a href="../reference/tm_shape.html">tm_shape</a></span><span class="op">(</span><span class="va">World</span>, crs <span class="op">=</span> <span class="fl">8857</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/tm_cartogram.html">tm_cartogram</a></span><span class="op">(</span>size <span class="op">=</span> <span class="st">"pop_est"</span>, fill <span class="op">=</span> <span class="st">"income_grp"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required namespace: cartogram</span></span>
<span><span class="co">#&gt; Cartogram in progress...</span></span></code></pre></div>
<p><img src="03_tmap_vv_files/figure-html/unnamed-chunk-8-1.png"><!-- --></p>
<p>We used two variables: <code>size</code> to deform the polygons using a continuous cartogram and <code>fill</code> to color the polygons.
The former is an example of a <em>transformation variable</em>.
In our example dataset:</p>
<pre><code><span><span class="co">#&gt;       geom         x1 x_scaled geom_transformed</span></span>
<span><span class="co">#&gt; 1 polygon1    491,775   0.0007        polygon1'</span></span>
<span><span class="co">#&gt; 2 polygon2  2,231,503   0.0033        polygon2'</span></span>
<span><span class="co">#&gt; 3 polygon3 34,859,364   0.0554        polygon3'</span></span>
<span><span class="co">#&gt; 4 polygon4  4,320,748   0.0067        polygon4'</span></span>
<span><span class="co">#&gt; 5      ...        ...      ...              ...</span></span></code></pre>
<p>The data variable <code>x1</code>, in the example <code>pop_est</code> (population estimation), is scaled to <code>x1_scaled</code> which is, in this case, a normalization using a continuous scale.
Next, the geometries are distorted such that the areas are proportional to <code>x1_scaled</code> (as much as the cartogram algorithm is able to achieve).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martijn Tennekes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
